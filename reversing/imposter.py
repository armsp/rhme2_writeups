import struct
magic = [0x373d3943, 0xe2a21b5b, 0xe2a21b5b, 0x8e06fd73, 0x8e06fd73, 0x396bdf8b, 0x396bdf8b, 0xf7354e81, 0xe4d0c1a3, 0xa29a3099, 0x9035a3bb, 0x4dff12b1, 0x3b9a85d3, 0xf963f4c9, 0xe6ff67eb, 0x5ba7d770, 0x92644a03, 0x070cb988, 0x3dc92c1b, 0xb2719ba0, 0xe92e0e33, 0x5dd67db8, 0x9492f04b, 0x0c83d59b, 0x3ff7d263, 0xb7e8b7b3, 0xeb5cb47b, 0x634d99cb, 0x96c19693, 0x0eb27be3, 0x422678ab, 0xed8b5ac3, 0xed8b5ac3, 0x98f03cdb, 0x98f03cdb, 0x44551ef3, 0x44551ef3, 0xefba010b, 0xefba010b, 0xad837001, 0x9b1ee323, 0x58e85219, 0x4683c53b, 0x044d3431, 0xf1e8a753, 0x669116d8, 0x9d4d896b, 0x11f5f8f0, 0x48b26b83, 0xbd5adb08, 0xf4174d9b, 0x68bfbd20, 0x9f7c2fb3, 0x176d1503, 0x4ae111cb, 0xc2d1f71b, 0xf645f3e3, 0x6e36d933, 0xa1aad5fb, 0x199bbb4b, 0x4d0fb813, 0xf8749a2b, 0xf8749a2b, 0xa3d97c43]

flag = ''
for inp in ([0xfc791d6b, 0x924e6c8f], [0x795f34a2,  0x0edae901]):
    for x in range(63,-1,-1):
        a6 = inp[1]
        inp[1] = inp[0]
        a1 = (inp[1] << 4) & 0xffffffff
        a2 = (inp[1] >> 5)
        a3 = a1 ^ a2
        a4 = (a3 + inp[1]) & 0xffffffff
        a5 = a4 ^ magic[min(x,63)]
        if a5 > a6:
            inp[0] = (0x100000000 + a6 - a5)
        else:
            inp[0] = (a6 - a5) & 0xffffffff
    flag += struct.pack("<L",inp[0]) + struct.pack("<L",inp[1])
print "FLAG:", flag
